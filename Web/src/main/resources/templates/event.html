<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<div class="container">

    <h1 style="display: inline;" th:text="'Event: ' + ${event.name}">Event: </h1>


    <a class="btn btn-primary" style="float: right;" th:href="@{'/event/' +${event.name} + '/import'}">
        Import
    </a>

    <a class="btn btn-primary" style="float: right;" th:href="@{'/event/' +${event.name} + '/invitation'}">
        <i class="fa fa-user-plus" aria-hidden="true"></i>
        Join
    </a>


    <div th:each="configuration: ${foodOptionConfigurations}">
        <h2 style="display: inline;" th:text="${configuration.name}"></h2>

        <form style="display: none" class="nameForm" th:action="@{'/event/' + ${event.name} + '/' + ${configuration.name} + '/change_name'}" method="post">
            <label><input name="name" th:value="${configuration.name}"/></label>
            <button type="submit" class="btn">
                Submit
            </button>
        </form>

        <a onclick="$(this).closest('div').find('.nameForm').css('display', 'initial');$(this).css('display', 'none');$(this).closest('div').find('h2').css('display', 'none');">
            <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
            edit
        </a>

        <form th:action="@{'/event/' + ${event.name} + '/' + ${configuration.name} + '/delete'}" method="post">
            <button type="submit" class="btn btn-primary" th:href="@{'/event/' + ${event.name} + '/' + ${configuration.name} + '/delete'}">
                <i class="fa fa-trash" aria-hidden="true"></i>
                delete
            </button>
        </form>

        <a class="btn btn-primary" th:href="@{'/event/' + ${event.name} + '/' + ${configuration.name} + '/add_food'}">
            <i class="fa fa-plus-square" aria-hidden="true"></i>
            Add food
        </a>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Name</th>
                <th>Price</th>
                <th>Extra options</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="foodOption: ${configuration.foodOptions}">
                <td th:text="${foodOption.name}"></td>
                <td th:text="${foodOption.price}"></td>
                <td th:text="${foodOption.extraOptionsAsString}"></td>
                <td>
                    <form th:action="@{'/event/' + ${event.name} + '/' + ${configuration.name} +'/' + ${foodOption.name} + '/delete'}" method="post">
                        <button type="submit" class="btn btn-primary" th:href="@{'/event/' + ${event.name} + '/' + ${configuration.name} + '/delete'}">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                            delete
                        </button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>

    </div>


    <div th:if="${!#lists.isEmpty(participants)}">
        <h2>Participants</h2>

        <table class="table table-striped">
            <thead>
            <tr>
                <th>Username</th>
                <th>Food choices</th>
                <th>Total</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="participant: ${participants}">
                <td th:text="${participant.username}"></td>
                <td th:text="${participant.selectedChoicesAsString}"></td>
                <td th:text="${participant.totalPrice}"></td>
                <td>
                    <a th:href="@{'/event/' + ${event.name} + '/remove/' + ${participant.username}}">
                        <i class="fa fa-times" aria-hidden="true"></i>
                        Remove
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
</body>
</html>
